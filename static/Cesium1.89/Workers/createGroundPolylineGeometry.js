define(["./Transforms-53e3607a","./Matrix2-a3269947","./RuntimeError-346a3079","./when-4bbc8319","./ComponentDatatype-93750d1a","./ArcType-98ec98bf","./arrayRemoveDuplicates-18786327","./EllipsoidGeodesic-aa7c9d72","./EllipsoidRhumbLine-d2c20afd","./EncodedCartesian3-d8e256ef","./GeometryAttribute-f4cf259b","./IntersectionTests-e90cbdec","./Plane-4d8d92e1","./WebMercatorProjection-87fdc309","./combine-83860057","./WebGLConstants-1c8239cc"],(function(e,a,t,i,n,r,s,o,l,u,c,C,h,d,p,f){"use strict";function g(t){if(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT),i.defined(t.tileInfo)&&i.defined(t.tileInfo.spatialReference)&&i.defined(t.tileInfo.spatialReference.wkid)&&4490==t.tileInfo.spatialReference.wkid){this._tileInfo=t.tileInfo,this._ellipsoid=i.defaultValue(t.ellipsoid,a.Ellipsoid.CGCS2000);var n=t.tileInfo.origin.x,r=t.tileInfo.origin.y;this._rectangle=i.defaultValue(t.rectangle,a.Rectangle.fromDegrees(n,-90,180,r)),this._numberOfLevelZeroTilesX=i.defaultValue(t.numberOfLevelZeroTilesX,4),this._numberOfLevelZeroTilesY=i.defaultValue(t.numberOfLevelZeroTilesY,2)}else this._ellipsoid=i.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),this._rectangle=i.defaultValue(t.rectangle,a.Rectangle.MAX_VALUE),this._numberOfLevelZeroTilesX=i.defaultValue(t.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=i.defaultValue(t.numberOfLevelZeroTilesY,1);this._projection=new e.GeographicProjection(this._ellipsoid)}Object.defineProperties(g.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),g.prototype.getNumberOfXTilesAtLevel=function(e){if(i.defined(this._tileInfo)){var a=this._tileInfo.lods.filter((function(a){return a.level===e}))[0].resolution;return Math.round(n.CesiumMath.toDegrees(n.CesiumMath.TWO_PI)/(this._tileInfo.rows*a))}return this._numberOfLevelZeroTilesX<<e},g.prototype.getNumberOfYTilesAtLevel=function(e){if(i.defined(this._tileInfo)){var a=this._tileInfo.lods.filter((function(a){return a.level===e}))[0].resolution;return Math.round(n.CesiumMath.toDegrees(n.CesiumMath.TWO_PI/2)/(this._tileInfo.cols*a))}return this._numberOfLevelZeroTilesY<<e},g.prototype.rectangleToNativeRectangle=function(e,t){var r=n.CesiumMath.toDegrees(e.west),s=n.CesiumMath.toDegrees(e.south),o=n.CesiumMath.toDegrees(e.east),l=n.CesiumMath.toDegrees(e.north);return i.defined(t)?(t.west=r,t.south=s,t.east=o,t.north=l,t):new a.Rectangle(r,s,o,l)},g.prototype.tileXYToNativeRectangle=function(e,a,t,i){var r=this.tileXYToRectangle(e,a,t,i);return r.west=n.CesiumMath.toDegrees(r.west),r.south=n.CesiumMath.toDegrees(r.south),r.east=n.CesiumMath.toDegrees(r.east),r.north=n.CesiumMath.toDegrees(r.north),r},g.prototype.tileXYToRectangle=function(e,t,r,s){var o=this._rectangle,l=0,u=0,c=0,C=0;if(i.defined(this._tileInfo)){var h=this._tileInfo.lods.filter((function(e){return e.level===r}))[0].resolution;c=this._tileInfo.origin.y-t*(this._tileInfo.cols*h),l=this._tileInfo.origin.x+e*(this._tileInfo.rows*h),C=this._tileInfo.origin.y-(t+1)*(this._tileInfo.cols*h),u=this._tileInfo.origin.x+(e+1)*(this._tileInfo.rows*h),l=n.CesiumMath.toRadians(l),c=n.CesiumMath.toRadians(c),u=n.CesiumMath.toRadians(u),C=n.CesiumMath.toRadians(C)}else{var d=this.getNumberOfXTilesAtLevel(r),p=this.getNumberOfYTilesAtLevel(r),f=o.width/d;l=e*f+o.west,u=(e+1)*f+o.west;var g=o.height/p;c=o.north-t*g,C=o.north-(t+1)*g}return i.defined(s)||(s=new a.Rectangle(l,C,u,c)),s.west=l,s.south=C,s.east=u,s.north=c,s},g.prototype.positionToTileXY=function(e,t,r){var s=this._rectangle;if(a.Rectangle.contains(s,e)){if(i.defined(this._tileInfo)){var o=this._tileInfo.lods.filter((function(e){return e.level===t}))[0].resolution,l=n.CesiumMath.toDegrees(e.longitude),u=n.CesiumMath.toDegrees(e.latitude),c=Math.floor((l-this._tileInfo.origin.x)/(this._tileInfo.rows*o)),C=Math.floor((this._tileInfo.origin.y-u)/(this._tileInfo.cols*o));return new a.Cartesian2(c,C)}var h=this.getNumberOfXTilesAtLevel(t),d=this.getNumberOfYTilesAtLevel(t),p=s.width/h,f=s.height/d,g=e.longitude;s.east<s.west&&(g+=n.CesiumMath.TWO_PI);var m=(g-s.west)/p|0;m>=h&&(m=h-1);var v=(s.north-e.latitude)/f|0;return v>=d&&(v=d-1),i.defined(r)?(r.x=m,r.y=v,r):new a.Cartesian2(m,v)}};var m=new a.Cartesian3,v=new a.Cartesian3,w=new a.Cartographic,y=new a.Cartesian3,_=new a.Cartesian3,M=new e.BoundingSphere,T=new g,E=[new a.Cartographic,new a.Cartographic,new a.Cartographic,new a.Cartographic],I=new a.Cartesian2,O={};function b(e){a.Cartographic.fromRadians(e.east,e.north,0,E[0]),a.Cartographic.fromRadians(e.west,e.north,0,E[1]),a.Cartographic.fromRadians(e.east,e.south,0,E[2]),a.Cartographic.fromRadians(e.west,e.south,0,E[3]);var t,i=0,n=0,r=0,s=0,o=O._terrainHeightsMaxLevel;for(t=0;t<=o;++t){for(var l=!1,u=0;u<4;++u){var c=E[u];if(T.positionToTileXY(c,t,I),0===u)r=I.x,s=I.y;else if(r!==I.x||s!==I.y){l=!0;break}}if(l)break;i=r,n=s}if(0!==t)return{x:i,y:n,level:t>o?o:t-1}}O.initialize=function(){var a=O._initPromise;return i.defined(a)||(a=e.Resource.fetchJson(e.buildModuleUrl("Assets/approximateTerrainHeights.json")).then((function(e){O._terrainHeights=e})),O._initPromise=a),a},O.getMinimumMaximumHeights=function(e,t){t=i.defaultValue(t,a.Ellipsoid.WGS84);var n=b(e),r=O._defaultMinTerrainHeight,s=O._defaultMaxTerrainHeight;if(i.defined(n)){var o=n.level+"-"+n.x+"-"+n.y,l=O._terrainHeights[o];i.defined(l)&&(r=l[0],s=l[1]),t.cartographicToCartesian(a.Rectangle.northeast(e,w),m),t.cartographicToCartesian(a.Rectangle.southwest(e,w),v),a.Cartesian3.midpoint(v,m,y);var u=t.scaleToGeodeticSurface(y,_);if(i.defined(u)){var c=a.Cartesian3.distance(y,u);r=Math.min(r,-c)}else r=O._defaultMinTerrainHeight}return{minimumTerrainHeight:r=Math.max(O._defaultMinTerrainHeight,r),maximumTerrainHeight:s}},O.getBoundingSphere=function(t,n){n=i.defaultValue(n,a.Ellipsoid.WGS84);var r=b(t),s=O._defaultMaxTerrainHeight;if(i.defined(r)){var o=r.level+"-"+r.x+"-"+r.y,l=O._terrainHeights[o];i.defined(l)&&(s=l[1])}var u=e.BoundingSphere.fromRectangle3D(t,n,0);return e.BoundingSphere.fromRectangle3D(t,n,s,M),e.BoundingSphere.union(u,M,u)},O._terrainHeightsMaxLevel=6,O._defaultMaxTerrainHeight=9e3,O._defaultMinTerrainHeight=-1e5,O._terrainHeights=void 0,O._initPromise=void 0,Object.defineProperties(O,{initialized:{get:function(){return i.defined(O._terrainHeights)}}});var P=[e.GeographicProjection,d.WebMercatorProjection],L=P.length,k=Math.cos(n.CesiumMath.toRadians(30)),A=Math.cos(n.CesiumMath.toRadians(150));function S(e){var t=(e=i.defaultValue(e,i.defaultValue.EMPTY_OBJECT)).positions;this.width=i.defaultValue(e.width,1),this._positions=t,this.granularity=i.defaultValue(e.granularity,9999),this.loop=i.defaultValue(e.loop,!1),this.arcType=i.defaultValue(e.arcType,r.ArcType.GEODESIC),this._ellipsoid=a.Ellipsoid.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(S.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+1+a.Ellipsoid.packedLength+1+1}}}),S.setProjectionAndEllipsoid=function(e,a){for(var t=0,i=0;i<L;i++)if(a instanceof P[i]){t=i;break}e._projectionIndex=t,e._ellipsoid=a.ellipsoid};var x=new a.Cartesian3,R=new a.Cartesian3,D=new a.Cartesian3;function N(e,t,i,n,r){var s=Y(n,e,0,x),o=Y(n,e,i,R),l=Y(n,t,0,D),u=X(o,s,R),c=X(l,s,D);return a.Cartesian3.cross(c,u,r),a.Cartesian3.normalize(r,r)}var z=new a.Cartographic,V=new a.Cartesian3,H=new a.Cartesian3,B=new a.Cartesian3;function G(e,t,i,n,s,u,c,C,h,d,p){if(0!==s){var f;u===r.ArcType.GEODESIC?f=new o.EllipsoidGeodesic(e,t,c):u===r.ArcType.RHUMB&&(f=new l.EllipsoidRhumbLine(e,t,c));var g=f.surfaceDistance;if(!(g<s))for(var m=N(e,t,n,c,B),v=Math.ceil(g/s),w=g/v,y=w,_=v-1,M=C.length,T=0;T<_;T++){var E=f.interpolateUsingSurfaceDistance(y,z),I=Y(c,E,i,V),O=Y(c,E,n,H);a.Cartesian3.pack(m,C,M),a.Cartesian3.pack(I,h,M),a.Cartesian3.pack(O,d,M),p.push(E.latitude),p.push(E.longitude),M+=3,y+=w}}}var j=new a.Cartographic;function Y(e,t,i,n){return a.Cartographic.clone(t,j),j.height=i,a.Cartographic.toCartesian(j,e,n)}function X(e,t,i){return a.Cartesian3.subtract(e,t,i),a.Cartesian3.normalize(i,i),i}function F(e,t,i,n){return n=X(e,t,n),n=a.Cartesian3.cross(n,i,n),n=a.Cartesian3.normalize(n,n),n=a.Cartesian3.cross(i,n,n)}S.pack=function(e,t,n){var r=i.defaultValue(n,0),s=e._positions,o=s.length;t[r++]=o;for(var l=0;l<o;++l){var u=s[l];a.Cartesian3.pack(u,t,r),r+=3}return t[r++]=e.granularity,t[r++]=e.loop?1:0,t[r++]=e.arcType,a.Ellipsoid.pack(e._ellipsoid,t,r),r+=a.Ellipsoid.packedLength,t[r++]=e._projectionIndex,t[r++]=e._scene3DOnly?1:0,t},S.unpack=function(e,t,n){for(var r=i.defaultValue(t,0),s=e[r++],o=new Array(s),l=0;l<s;l++)o[l]=a.Cartesian3.unpack(e,r),r+=3;var u=e[r++],c=1===e[r++],C=e[r++],h=a.Ellipsoid.unpack(e,r);r+=a.Ellipsoid.packedLength;var d=e[r++],p=1===e[r++];return i.defined(n)||(n=new S({positions:o})),n._positions=o,n.granularity=u,n.loop=c,n.arcType=C,n._ellipsoid=h,n._projectionIndex=d,n._scene3DOnly=p,n};var W=new a.Cartesian3,q=new a.Cartesian3,Z=new a.Cartesian3,U=new a.Cartesian3;function J(e,t,i,r,s){var o=X(i,t,U),l=F(e,t,o,W),u=F(r,t,o,q);if(n.CesiumMath.equalsEpsilon(a.Cartesian3.dot(l,u),-1,n.CesiumMath.EPSILON5))return s=a.Cartesian3.cross(o,l,s),s=a.Cartesian3.normalize(s,s);s=a.Cartesian3.add(u,l,s),s=a.Cartesian3.normalize(s,s);var c=a.Cartesian3.cross(o,s,Z);return a.Cartesian3.dot(u,c)<0&&(s=a.Cartesian3.negate(s,s)),s}var Q=h.Plane.fromPointNormal(a.Cartesian3.ZERO,a.Cartesian3.UNIT_Y),K=new a.Cartesian3,$=new a.Cartesian3,ee=new a.Cartesian3,ae=new a.Cartesian3,te=new a.Cartesian3,ie=new a.Cartesian3,ne=new a.Cartographic,re=new a.Cartographic,se=new a.Cartographic;S.createGeometry=function(t){var o,h,d,p,f,g,m=!t._scene3DOnly,v=t.loop,w=t._ellipsoid,y=t.granularity,_=t.arcType,M=new P[t._projectionIndex](w),T=1e3,E=t._positions,I=E.length;2===I&&(v=!1);var b,L,A,S=new l.EllipsoidRhumbLine(void 0,void 0,w),x=[E[0]];for(h=0;h<I-1;h++)d=E[h],p=E[h+1],b=C.IntersectionTests.lineSegmentPlane(d,p,Q,ie),!i.defined(b)||a.Cartesian3.equalsEpsilon(b,d,n.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(b,p,n.CesiumMath.EPSILON7)||(t.arcType===r.ArcType.GEODESIC?x.push(a.Cartesian3.clone(b)):t.arcType===r.ArcType.RHUMB&&(A=w.cartesianToCartographic(b,ne).longitude,f=w.cartesianToCartographic(d,ne),g=w.cartesianToCartographic(p,re),S.setEndPoints(f,g),L=S.findIntersectionWithLongitude(A,se),b=w.cartographicToCartesian(L,ie),!i.defined(b)||a.Cartesian3.equalsEpsilon(b,d,n.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(b,p,n.CesiumMath.EPSILON7)||x.push(a.Cartesian3.clone(b)))),x.push(p);v&&(d=E[I-1],p=E[0],b=C.IntersectionTests.lineSegmentPlane(d,p,Q,ie),!i.defined(b)||a.Cartesian3.equalsEpsilon(b,d,n.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(b,p,n.CesiumMath.EPSILON7)||(t.arcType===r.ArcType.GEODESIC?x.push(a.Cartesian3.clone(b)):t.arcType===r.ArcType.RHUMB&&(A=w.cartesianToCartographic(b,ne).longitude,f=w.cartesianToCartographic(d,ne),g=w.cartesianToCartographic(p,re),S.setEndPoints(f,g),L=S.findIntersectionWithLongitude(A,se),b=w.cartographicToCartesian(L,ie),!i.defined(b)||a.Cartesian3.equalsEpsilon(b,d,n.CesiumMath.EPSILON7)||a.Cartesian3.equalsEpsilon(b,p,n.CesiumMath.EPSILON7)||x.push(a.Cartesian3.clone(b)))));var R=x.length,D=new Array(R);for(h=0;h<R;h++){var z=a.Cartographic.fromCartesian(x[h],w);z.height=0,D[h]=z}if(!((R=(D=s.arrayRemoveDuplicates(D,a.Cartographic.equalsEpsilon)).length)<2)){var V=[],H=[],B=[],j=[],F=K,W=$,q=ee,Z=ae,U=te,oe=D[0],le=D[1];for(F=Y(w,D[R-1],0,F),Z=Y(w,le,0,Z),W=Y(w,oe,0,W),q=Y(w,oe,T,q),U=v?J(F,W,q,Z,U):N(oe,le,T,w,U),a.Cartesian3.pack(U,H,0),a.Cartesian3.pack(W,B,0),a.Cartesian3.pack(q,j,0),V.push(oe.latitude),V.push(oe.longitude),G(oe,le,0,T,y,_,w,H,B,j,V),h=1;h<R-1;++h){F=a.Cartesian3.clone(W,F),W=a.Cartesian3.clone(Z,W);var ue=D[h];Y(w,ue,T,q),Y(w,D[h+1],0,Z),J(F,W,q,Z,U),o=H.length,a.Cartesian3.pack(U,H,o),a.Cartesian3.pack(W,B,o),a.Cartesian3.pack(q,j,o),V.push(ue.latitude),V.push(ue.longitude),G(D[h],D[h+1],0,T,y,_,w,H,B,j,V)}var Ce=D[R-1],he=D[R-2];if(W=Y(w,Ce,0,W),q=Y(w,Ce,T,q),v){var de=D[0];U=J(F=Y(w,he,0,F),W,q,Z=Y(w,de,0,Z),U)}else U=N(he,Ce,T,w,U);if(o=H.length,a.Cartesian3.pack(U,H,o),a.Cartesian3.pack(W,B,o),a.Cartesian3.pack(q,j,o),V.push(Ce.latitude),V.push(Ce.longitude),v){for(G(Ce,oe,0,T,y,_,w,H,B,j,V),o=H.length,h=0;h<3;++h)H[o+h]=H[h],B[o+h]=B[h],j[o+h]=j[h];V.push(oe.latitude),V.push(oe.longitude)}return function(t,i,r,s,o,l,C){var h,d,p,f,g,m,v=i._ellipsoid,w=r.length/3-1,y=8*w,_=4*y,M=36*w,T=y>65535?new Uint32Array(M):new Uint16Array(M),E=new Float64Array(3*y),I=new Float32Array(_),b=new Float32Array(_),P=new Float32Array(_),L=new Float32Array(_),A=new Float32Array(_);C&&(p=new Float32Array(_),f=new Float32Array(_),g=new Float32Array(_),m=new Float32Array(2*y));var S=l.length/2,x=0,R=_e;R.height=0;var D=Me;D.height=0;var N=Te,z=Ee;if(C)for(d=0,h=1;h<S;h++)R.latitude=l[d],R.longitude=l[d+1],D.latitude=l[d+2],D.longitude=l[d+3],N=i.project(R,N),z=i.project(D,z),x+=a.Cartesian3.distance(N,z),d+=2;var V=s.length/3;z=a.Cartesian3.unpack(s,0,z);var H,B=0;for(d=3,h=1;h<V;h++)N=a.Cartesian3.clone(z,N),z=a.Cartesian3.unpack(s,d,z),B+=a.Cartesian3.distance(N,z),d+=3;d=3;var G=0,j=0,Y=0,F=0,W=!1,q=a.Cartesian3.unpack(r,0,Oe),Z=a.Cartesian3.unpack(s,0,Ee),U=a.Cartesian3.unpack(o,0,Pe);if(t){ce(U,a.Cartesian3.unpack(r,r.length-6,Ie),q,Z)&&(U=a.Cartesian3.negate(U,U))}var J=0,Q=0,K=0;for(h=0;h<w;h++){var $,ee,ae,te,ie=a.Cartesian3.clone(q,Ie),ne=a.Cartesian3.clone(Z,Te),re=a.Cartesian3.clone(U,be);if(W&&(re=a.Cartesian3.negate(re,re)),q=a.Cartesian3.unpack(r,d,Oe),Z=a.Cartesian3.unpack(s,d,Ee),W=ce(U=a.Cartesian3.unpack(o,d,Pe),ie,q,Z),R.latitude=l[G],R.longitude=l[G+1],D.latitude=l[G+2],D.longitude=l[G+3],C){var se=ye(R,D);$=i.project(R,De);var oe=X(ee=i.project(D,Ne),$,qe);oe.y=Math.abs(oe.y),ae=ze,te=Ve,0===se||a.Cartesian3.dot(oe,a.Cartesian3.UNIT_Y)>k?(ae=pe(i,R,re,$,ze),te=pe(i,D,U,ee,Ve)):1===se?(te=pe(i,D,U,ee,Ve),ae.x=0,ae.y=n.CesiumMath.sign(R.longitude-Math.abs(D.longitude)),ae.z=0):(ae=pe(i,R,re,$,ze),te.x=0,te.y=n.CesiumMath.sign(R.longitude-D.longitude),te.z=0)}var le=a.Cartesian3.distance(ne,Z),ue=u.EncodedCartesian3.fromCartesian(ie,Fe),Ce=a.Cartesian3.subtract(q,ie,He),he=a.Cartesian3.normalize(Ce,je),de=a.Cartesian3.subtract(ne,ie,Be);de=a.Cartesian3.normalize(de,de);var fe=a.Cartesian3.cross(he,de,je);fe=a.Cartesian3.normalize(fe,fe);var ge=a.Cartesian3.cross(de,re,Ye);ge=a.Cartesian3.normalize(ge,ge);var ve=a.Cartesian3.subtract(Z,q,Ge);ve=a.Cartesian3.normalize(ve,ve);var ea=a.Cartesian3.cross(U,ve,Xe);ea=a.Cartesian3.normalize(ea,ea);var aa,ta,ia,na=le/B,ra=J/B,sa=0,oa=0,la=0;if(C){sa=a.Cartesian3.distance($,ee),aa=u.EncodedCartesian3.fromCartesian($,We),ta=a.Cartesian3.subtract(ee,$,qe);var ua=(ia=a.Cartesian3.normalize(ta,Ze)).x;ia.x=ia.y,ia.y=-ua,oa=sa/x,la=Q/x}for(H=0;H<8;H++){var ca=F+4*H,Ca=j+2*H,ha=ca+3,da=H<4?1:-1,pa=2===H||3===H||6===H||7===H?1:-1;a.Cartesian3.pack(ue.high,I,ca),I[ha]=Ce.x,a.Cartesian3.pack(ue.low,b,ca),b[ha]=Ce.y,a.Cartesian3.pack(ge,P,ca),P[ha]=Ce.z,a.Cartesian3.pack(ea,L,ca),L[ha]=na*da,a.Cartesian3.pack(fe,A,ca);var fa=ra*pa;0===fa&&pa<0&&(fa=9),A[ha]=fa,C&&(p[ca]=aa.high.x,p[ca+1]=aa.high.y,p[ca+2]=aa.low.x,p[ca+3]=aa.low.y,g[ca]=-ae.y,g[ca+1]=ae.x,g[ca+2]=te.y,g[ca+3]=-te.x,f[ca]=ta.x,f[ca+1]=ta.y,f[ca+2]=ia.x,f[ca+3]=ia.y,m[Ca]=oa*da,0===(fa=la*pa)&&pa<0&&(fa=9),m[Ca+1]=fa)}var ga=xe,ma=Re,va=Ae,wa=Se,ya=a.Rectangle.fromCartographicArray(Le,ke),_a=O.getMinimumMaximumHeights(ya,v),Ma=_a.minimumTerrainHeight,Ta=_a.maximumTerrainHeight;K+=Ma,K+=Ta,me(ie,ne,Ma,Ta,ga,va),me(q,Z,Ma,Ta,ma,wa);var Ea=a.Cartesian3.multiplyByScalar(fe,n.CesiumMath.EPSILON5,Ue);a.Cartesian3.add(ga,Ea,ga),a.Cartesian3.add(ma,Ea,ma),a.Cartesian3.add(va,Ea,va),a.Cartesian3.add(wa,Ea,wa),we(ga,ma),we(va,wa),a.Cartesian3.pack(ga,E,Y),a.Cartesian3.pack(ma,E,Y+3),a.Cartesian3.pack(wa,E,Y+6),a.Cartesian3.pack(va,E,Y+9),Ea=a.Cartesian3.multiplyByScalar(fe,-2*n.CesiumMath.EPSILON5,Ue),a.Cartesian3.add(ga,Ea,ga),a.Cartesian3.add(ma,Ea,ma),a.Cartesian3.add(va,Ea,va),a.Cartesian3.add(wa,Ea,wa),we(ga,ma),we(va,wa),a.Cartesian3.pack(ga,E,Y+12),a.Cartesian3.pack(ma,E,Y+15),a.Cartesian3.pack(wa,E,Y+18),a.Cartesian3.pack(va,E,Y+21),G+=2,d+=3,j+=16,Y+=24,F+=32,J+=le,Q+=sa}d=0;var Ia=0;for(h=0;h<w;h++){for(H=0;H<Ke;H++)T[d+H]=Qe[H]+Ia;Ia+=8,d+=Ke}var Oa=Je;e.BoundingSphere.fromVertices(r,a.Cartesian3.ZERO,3,Oa[0]),e.BoundingSphere.fromVertices(s,a.Cartesian3.ZERO,3,Oa[1]);var ba=e.BoundingSphere.fromBoundingSpheres(Oa);ba.radius+=K/(2*w);var Pa={position:new c.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,normalize:!1,values:E}),startHiAndForwardOffsetX:$e(I),startLoAndForwardOffsetY:$e(b),startNormalAndForwardOffsetZ:$e(P),endNormalAndTextureCoordinateNormalizationX:$e(L),rightNormalAndTextureCoordinateNormalizationY:$e(A)};C&&(Pa.startHiLo2D=$e(p),Pa.offsetAndRight2D=$e(f),Pa.startEndNormals2D=$e(g),Pa.texcoordNormalization2D=new c.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1,values:m}));return new c.Geometry({attributes:Pa,indices:T,boundingSphere:ba})}(v,M,B,j,H,V,m)}};var oe=new a.Cartesian3,le=new a.Matrix3,ue=new e.Quaternion;function ce(t,i,r,s){var o=X(r,i,oe),l=a.Cartesian3.dot(o,t);if(l>k||l<A){var u=X(s,r,U),c=l<A?n.CesiumMath.PI_OVER_TWO:-n.CesiumMath.PI_OVER_TWO,C=e.Quaternion.fromAxisAngle(u,c,ue),h=a.Matrix3.fromQuaternion(C,le);return a.Matrix3.multiplyByVector(h,t,t),!0}return!1}var Ce=new a.Cartographic,he=new a.Cartesian3,de=new a.Cartesian3;function pe(e,t,i,r,s){var o=a.Cartographic.toCartesian(t,e._ellipsoid,he),l=a.Cartesian3.add(o,i,de),u=!1,c=e._ellipsoid,C=c.cartesianToCartographic(l,Ce);Math.abs(t.longitude-C.longitude)>n.CesiumMath.PI_OVER_TWO&&(u=!0,l=a.Cartesian3.subtract(o,i,de),C=c.cartesianToCartographic(l,Ce)),C.height=0;var h=e.project(C,s);return(s=a.Cartesian3.subtract(h,r,s)).z=0,s=a.Cartesian3.normalize(s,s),u&&a.Cartesian3.negate(s,s),s}var fe=new a.Cartesian3,ge=new a.Cartesian3;function me(e,t,i,n,r,s){var o=a.Cartesian3.subtract(t,e,fe);a.Cartesian3.normalize(o,o);var l=i-0,u=a.Cartesian3.multiplyByScalar(o,l,ge);a.Cartesian3.add(e,u,r);var c=n-1e3;u=a.Cartesian3.multiplyByScalar(o,c,ge),a.Cartesian3.add(t,u,s)}var ve=new a.Cartesian3;function we(e,t){var i=h.Plane.getPointDistance(Q,e),r=h.Plane.getPointDistance(Q,t),s=ve;n.CesiumMath.equalsEpsilon(i,0,n.CesiumMath.EPSILON2)?(s=X(t,e,s),a.Cartesian3.multiplyByScalar(s,n.CesiumMath.EPSILON2,s),a.Cartesian3.add(e,s,e)):n.CesiumMath.equalsEpsilon(r,0,n.CesiumMath.EPSILON2)&&(s=X(e,t,s),a.Cartesian3.multiplyByScalar(s,n.CesiumMath.EPSILON2,s),a.Cartesian3.add(t,s,t))}function ye(e,a){var t=Math.abs(e.longitude),i=Math.abs(a.longitude);if(n.CesiumMath.equalsEpsilon(t,n.CesiumMath.PI,n.CesiumMath.EPSILON11)){var r=n.CesiumMath.sign(a.longitude);return e.longitude=r*(t-n.CesiumMath.EPSILON11),1}if(n.CesiumMath.equalsEpsilon(i,n.CesiumMath.PI,n.CesiumMath.EPSILON11)){var s=n.CesiumMath.sign(e.longitude);return a.longitude=s*(i-n.CesiumMath.EPSILON11),2}return 0}var _e=new a.Cartographic,Me=new a.Cartographic,Te=new a.Cartesian3,Ee=new a.Cartesian3,Ie=new a.Cartesian3,Oe=new a.Cartesian3,be=new a.Cartesian3,Pe=new a.Cartesian3,Le=[_e,Me],ke=new a.Rectangle,Ae=new a.Cartesian3,Se=new a.Cartesian3,xe=new a.Cartesian3,Re=new a.Cartesian3,De=new a.Cartesian3,Ne=new a.Cartesian3,ze=new a.Cartesian3,Ve=new a.Cartesian3,He=new a.Cartesian3,Be=new a.Cartesian3,Ge=new a.Cartesian3,je=new a.Cartesian3,Ye=new a.Cartesian3,Xe=new a.Cartesian3,Fe=new u.EncodedCartesian3,We=new u.EncodedCartesian3,qe=new a.Cartesian3,Ze=new a.Cartesian3,Ue=new a.Cartesian3,Je=[new e.BoundingSphere,new e.BoundingSphere],Qe=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Ke=Qe.length;function $e(e){return new c.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}return S._projectNormal=pe,function(e,a){return O.initialize().then((function(){return i.defined(a)&&(e=S.unpack(e,a)),S.createGeometry(e)}))}}));
